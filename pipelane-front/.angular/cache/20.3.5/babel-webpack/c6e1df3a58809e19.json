{"ast":null,"code":"import { DatePipe, NgIf } from '@angular/common';\nimport { inject, signal } from '@angular/core';\nimport { FormControl, ReactiveFormsModule } from '@angular/forms';\nimport { Router } from '@angular/router';\nimport { MatTableDataSource, MatTableModule } from '@angular/material/table';\nimport { MatCardModule } from '@angular/material/card';\nimport { MatFormFieldModule } from '@angular/material/form-field';\nimport { MatInputModule } from '@angular/material/input';\nimport { MatButtonModule } from '@angular/material/button';\nimport { MatIconModule } from '@angular/material/icon';\nimport { MatPaginator, MatPaginatorModule } from '@angular/material/paginator';\nimport { MatSort, MatSortModule } from '@angular/material/sort';\nimport { MatProgressBarModule } from '@angular/material/progress-bar';\nimport { takeUntilDestroyed } from '@angular/core/rxjs-interop';\nimport { debounceTime, distinctUntilChanged } from 'rxjs/operators';\nimport { ApiService } from '../../core/api.service';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"@angular/material/table\";\nimport * as i3 from \"@angular/material/card\";\nimport * as i4 from \"@angular/material/form-field\";\nimport * as i5 from \"@angular/material/input\";\nimport * as i6 from \"@angular/material/button\";\nimport * as i7 from \"@angular/material/icon\";\nimport * as i8 from \"@angular/material/paginator\";\nimport * as i9 from \"@angular/material/sort\";\nimport * as i10 from \"@angular/material/progress-bar\";\nconst _c0 = () => [10, 20, 50];\nfunction ContactsListComponent_button_15_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r2 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 11);\n    i0.ɵɵlistener(\"click\", function ContactsListComponent_button_15_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r2);\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.clearSearch());\n    });\n    i0.ɵɵelementStart(1, \"mat-icon\");\n    i0.ɵɵtext(2, \"close\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction ContactsListComponent_mat_progress_bar_16_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"mat-progress-bar\", 12);\n  }\n}\nfunction ContactsListComponent_div_17_th_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 26);\n    i0.ɵɵtext(1, \"Name\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ContactsListComponent_div_17_td_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 27)(1, \"div\", 28);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 29);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const contact_r5 = ctx.$implicit;\n    const ctx_r2 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r2.formatName(contact_r5) || \"Unknown contact\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(contact_r5.phone || contact_r5.email);\n  }\n}\nfunction ContactsListComponent_div_17_th_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 26);\n    i0.ɵɵtext(1, \"Language\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ContactsListComponent_div_17_td_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 27);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const contact_r6 = ctx.$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(contact_r6.lang || \"n/a\");\n  }\n}\nfunction ContactsListComponent_div_17_th_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 26);\n    i0.ɵɵtext(1, \"Created\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ContactsListComponent_div_17_td_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 27);\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"date\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const contact_r7 = ctx.$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(2, 1, contact_r7.createdAt, \"mediumDate\"));\n  }\n}\nfunction ContactsListComponent_div_17_th_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"th\", 30);\n  }\n}\nfunction ContactsListComponent_div_17_td_13_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r8 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"td\", 31)(1, \"button\", 32);\n    i0.ɵɵlistener(\"click\", function ContactsListComponent_div_17_td_13_Template_button_click_1_listener() {\n      const contact_r9 = i0.ɵɵrestoreView(_r8).$implicit;\n      const ctx_r2 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r2.open(contact_r9));\n    });\n    i0.ɵɵelementStart(2, \"mat-icon\");\n    i0.ɵɵtext(3, \"chat\");\n    i0.ɵɵelementEnd()()();\n  }\n}\nfunction ContactsListComponent_div_17_tr_14_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"tr\", 33);\n  }\n}\nfunction ContactsListComponent_div_17_tr_15_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"tr\", 34);\n  }\n}\nfunction ContactsListComponent_div_17_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 13)(1, \"table\", 14);\n    i0.ɵɵelementContainerStart(2, 15);\n    i0.ɵɵtemplate(3, ContactsListComponent_div_17_th_3_Template, 2, 0, \"th\", 16)(4, ContactsListComponent_div_17_td_4_Template, 5, 2, \"td\", 17);\n    i0.ɵɵelementContainerEnd();\n    i0.ɵɵelementContainerStart(5, 18);\n    i0.ɵɵtemplate(6, ContactsListComponent_div_17_th_6_Template, 2, 0, \"th\", 16)(7, ContactsListComponent_div_17_td_7_Template, 2, 1, \"td\", 17);\n    i0.ɵɵelementContainerEnd();\n    i0.ɵɵelementContainerStart(8, 19);\n    i0.ɵɵtemplate(9, ContactsListComponent_div_17_th_9_Template, 2, 0, \"th\", 16)(10, ContactsListComponent_div_17_td_10_Template, 3, 4, \"td\", 17);\n    i0.ɵɵelementContainerEnd();\n    i0.ɵɵelementContainerStart(11, 20);\n    i0.ɵɵtemplate(12, ContactsListComponent_div_17_th_12_Template, 1, 0, \"th\", 21)(13, ContactsListComponent_div_17_td_13_Template, 4, 0, \"td\", 22);\n    i0.ɵɵelementContainerEnd();\n    i0.ɵɵtemplate(14, ContactsListComponent_div_17_tr_14_Template, 1, 0, \"tr\", 23)(15, ContactsListComponent_div_17_tr_15_Template, 1, 0, \"tr\", 24);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(16, \"mat-paginator\", 25);\n    i0.ɵɵlistener(\"page\", function ContactsListComponent_div_17_Template_mat_paginator_page_16_listener($event) {\n      i0.ɵɵrestoreView(_r4);\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.onPage($event));\n    });\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"dataSource\", ctx_r2.dataSource);\n    i0.ɵɵadvance(13);\n    i0.ɵɵproperty(\"matHeaderRowDef\", ctx_r2.displayedColumns)(\"matHeaderRowDefSticky\", true);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"matRowDefColumns\", ctx_r2.displayedColumns);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"length\", ctx_r2.total())(\"pageSize\", ctx_r2.pageSize)(\"pageSizeOptions\", i0.ɵɵpureFunction0(7, _c0));\n  }\n}\nfunction ContactsListComponent_ng_template_18_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 35)(1, \"mat-icon\");\n    i0.ɵɵtext(2, \"people_outline\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"p\");\n    i0.ɵɵtext(4, \"No contacts found. Try adjusting your search.\");\n    i0.ɵɵelementEnd()();\n  }\n}\nexport let ContactsListComponent = /*#__PURE__*/(() => {\n  var _staticBlock;\n  class ContactsListComponent {\n    constructor() {\n      this.api = inject(ApiService);\n      this.router = inject(Router);\n      this.searchControl = new FormControl('');\n      this.dataSource = new MatTableDataSource([]);\n      this.displayedColumns = ['name', 'lang', 'created', 'actions'];\n      this.total = signal(0, ...(ngDevMode ? [{\n        debugName: \"total\"\n      }] : []));\n      this.isLoading = signal(false, ...(ngDevMode ? [{\n        debugName: \"isLoading\"\n      }] : []));\n      this.pageIndex = 0;\n      this.pageSize = 10;\n      this.loadContacts('');\n      this.searchControl.valueChanges?.pipe(debounceTime(300), distinctUntilChanged(), takeUntilDestroyed()).subscribe(value => {\n        this.pageIndex = 0;\n        this.loadContacts(value ?? '');\n      });\n    }\n    ngAfterViewInit() {\n      this.dataSource.paginator = this.paginator;\n      this.dataSource.sort = this.sort;\n    }\n    reload() {\n      this.loadContacts(this.searchControl.value ?? '');\n    }\n    clearSearch() {\n      this.searchControl.setValue('');\n    }\n    onPage(event) {\n      this.pageIndex = event.pageIndex;\n      this.pageSize = event.pageSize;\n      this.loadContacts(this.searchControl.value ?? '');\n    }\n    open(contact) {\n      this.router.navigate(['/conversations', contact.id]);\n    }\n    formatName(contact) {\n      const parts = [contact.firstName, contact.lastName].filter(Boolean);\n      return parts.length ? parts.join(' ') : undefined;\n    }\n    loadContacts(query) {\n      this.isLoading.set(true);\n      this.api.searchContacts(query, this.pageIndex + 1, this.pageSize).subscribe({\n        next: response => {\n          this.dataSource.data = response.items;\n          this.total.set(response.total);\n          this.isLoading.set(false);\n        },\n        error: () => {\n          this.dataSource.data = [];\n          this.total.set(0);\n          this.isLoading.set(false);\n        }\n      });\n    }\n    static #_ = _staticBlock = () => (this.ɵfac = function ContactsListComponent_Factory(__ngFactoryType__) {\n      return new (__ngFactoryType__ || ContactsListComponent)();\n    }, this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: ContactsListComponent,\n      selectors: [[\"pl-contacts-list\"]],\n      viewQuery: function ContactsListComponent_Query(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵviewQuery(MatPaginator, 5);\n          i0.ɵɵviewQuery(MatSort, 5);\n        }\n        if (rf & 2) {\n          let _t;\n          i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.paginator = _t.first);\n          i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.sort = _t.first);\n        }\n      },\n      decls: 20,\n      vars: 5,\n      consts: [[\"emptyState\", \"\"], [1, \"surface-card\"], [1, \"header\"], [1, \"body-text-muted\"], [\"mat-stroked-button\", \"\", \"color\", \"primary\", 3, \"click\"], [\"appearance\", \"outline\", 1, \"search-field\"], [\"matPrefix\", \"\"], [\"matInput\", \"\", \"placeholder\", \"Search by name, phone or email\", 3, \"formControl\"], [\"mat-icon-button\", \"\", \"matSuffix\", \"\", 3, \"click\", 4, \"ngIf\"], [\"mode\", \"indeterminate\", 4, \"ngIf\"], [\"class\", \"table-wrapper\", 4, \"ngIf\", \"ngIfElse\"], [\"mat-icon-button\", \"\", \"matSuffix\", \"\", 3, \"click\"], [\"mode\", \"indeterminate\"], [1, \"table-wrapper\"], [\"mat-table\", \"\", \"matSort\", \"\", 1, \"mat-elevation-z1\", 3, \"dataSource\"], [\"matColumnDef\", \"name\"], [\"mat-header-cell\", \"\", \"mat-sort-header\", \"\", 4, \"matHeaderCellDef\"], [\"mat-cell\", \"\", 4, \"matCellDef\"], [\"matColumnDef\", \"lang\"], [\"matColumnDef\", \"created\"], [\"matColumnDef\", \"actions\"], [\"mat-header-cell\", \"\", 4, \"matHeaderCellDef\"], [\"mat-cell\", \"\", \"class\", \"actions\", 4, \"matCellDef\"], [\"mat-header-row\", \"\", 4, \"matHeaderRowDef\", \"matHeaderRowDefSticky\"], [\"mat-row\", \"\", \"class\", \"table-row\", 4, \"matRowDef\", \"matRowDefColumns\"], [3, \"page\", \"length\", \"pageSize\", \"pageSizeOptions\"], [\"mat-header-cell\", \"\", \"mat-sort-header\", \"\"], [\"mat-cell\", \"\"], [1, \"contact-name\"], [1, \"body-text-muted\", \"small\"], [\"mat-header-cell\", \"\"], [\"mat-cell\", \"\", 1, \"actions\"], [\"mat-icon-button\", \"\", \"color\", \"primary\", 3, \"click\"], [\"mat-header-row\", \"\"], [\"mat-row\", \"\", 1, \"table-row\"], [1, \"empty\"]],\n      template: function ContactsListComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          const _r1 = i0.ɵɵgetCurrentView();\n          i0.ɵɵelementStart(0, \"mat-card\", 1)(1, \"div\", 2)(2, \"div\")(3, \"h2\");\n          i0.ɵɵtext(4, \"Contacts\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(5, \"p\", 3);\n          i0.ɵɵtext(6, \"Search and browse contacts across channels.\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(7, \"button\", 4);\n          i0.ɵɵlistener(\"click\", function ContactsListComponent_Template_button_click_7_listener() {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.reload());\n          });\n          i0.ɵɵelementStart(8, \"mat-icon\");\n          i0.ɵɵtext(9, \"refresh\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵtext(10, \" Refresh \");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(11, \"mat-form-field\", 5)(12, \"mat-icon\", 6);\n          i0.ɵɵtext(13, \"search\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(14, \"input\", 7);\n          i0.ɵɵtemplate(15, ContactsListComponent_button_15_Template, 3, 0, \"button\", 8);\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(16, ContactsListComponent_mat_progress_bar_16_Template, 1, 0, \"mat-progress-bar\", 9)(17, ContactsListComponent_div_17_Template, 17, 8, \"div\", 10)(18, ContactsListComponent_ng_template_18_Template, 5, 0, \"ng-template\", null, 0, i0.ɵɵtemplateRefExtractor);\n          i0.ɵɵelementEnd();\n        }\n        if (rf & 2) {\n          const emptyState_r10 = i0.ɵɵreference(19);\n          i0.ɵɵadvance(14);\n          i0.ɵɵproperty(\"formControl\", ctx.searchControl);\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngIf\", ctx.searchControl.value);\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngIf\", ctx.isLoading());\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngIf\", ctx.dataSource.data.length > 0)(\"ngIfElse\", emptyState_r10);\n        }\n      },\n      dependencies: [ReactiveFormsModule, i1.DefaultValueAccessor, i1.NgControlStatus, i1.FormControlDirective, NgIf, MatTableModule, i2.MatTable, i2.MatHeaderCellDef, i2.MatHeaderRowDef, i2.MatColumnDef, i2.MatCellDef, i2.MatRowDef, i2.MatHeaderCell, i2.MatCell, i2.MatHeaderRow, i2.MatRow, MatCardModule, i3.MatCard, MatFormFieldModule, i4.MatFormField, i4.MatPrefix, i4.MatSuffix, MatInputModule, i5.MatInput, MatButtonModule, i6.MatButton, i6.MatIconButton, MatIconModule, i7.MatIcon, MatPaginatorModule, i8.MatPaginator, MatSortModule, i9.MatSort, i9.MatSortHeader, MatProgressBarModule, i10.MatProgressBar, DatePipe],\n      styles: [\".header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:var(--space-3);margin-bottom:var(--space-4)}.search-field[_ngcontent-%COMP%]{width:100%;margin-bottom:var(--space-4)}.table-wrapper[_ngcontent-%COMP%]{overflow-x:auto}.table-row[_ngcontent-%COMP%]{cursor:pointer;transition:background var(--transition-fast)}.table-row[_ngcontent-%COMP%]:hover{background:var(--color-surface-alt)}.actions[_ngcontent-%COMP%]{text-align:right}.empty[_ngcontent-%COMP%]{text-align:center;padding:var(--space-6) 0;color:var(--color-text-muted);display:flex;flex-direction:column;gap:var(--space-3);align-items:center}.empty[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:3rem;height:auto;width:auto}.contact-name[_ngcontent-%COMP%]{font-weight:600}.small[_ngcontent-%COMP%]{font-size:.85rem}\"],\n      changeDetection: 0\n    }));\n  }\n  _staticBlock();\n  return ContactsListComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}