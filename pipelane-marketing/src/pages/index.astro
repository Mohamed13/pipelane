---
import BaseLayout from "@layouts/Base.astro";
import Navbar from "@components/Navbar.astro";
import Footer from "@components/Footer.astro";
import Section from "@components/Section.astro";
import CTA from "@components/CTA.astro";
import StatCard from "@components/StatCard.astro";
import DemoForm from "@components/DemoForm.astro";
import NeonBadge from "@components/NeonBadge.astro";
import Icon from "@components/Icon.astro";

const heroBullets = [
  { label: "+ de réponses", icon: "sparkle" },
  { label: "Zéro oubli", icon: "calendar" },
  { label: "Tout au même endroit", icon: "multiTenant" }
];

const gains = [
  {
    title: "Gain de temps",
    description: "Fini les emails manuels et les relances oubliées. L’agent prépare et envoie pour vous.",
    icon: "automation"
  },
  {
    title: "Régularité",
    description: "Chaque jour, aux meilleures heures, votre pipe avance sans effort ni charge mentale.",
    icon: "calendar"
  },
  {
    title: "Résultats",
    description: "Plus de réponses, plus de rendez-vous qualifiés, sans sacrifier la personnalisation.",
    icon: "chartTrend"
  }
];

const workflowSteps = [
  {
    title: "Connectez vos canaux",
    description: "Email, WhatsApp, SMS : tout est prêt en quelques minutes.",
    icon: "message"
  },
  {
    title: "Importez vos contacts et votre pitch",
    description: "CSV ou CRM, l’agent s’adapte et prépare vos messages.",
    icon: "headset"
  },
  {
    title: "L’agent écrit, envoie, relance",
    description: "Toujours au bon moment, avec le bon angle, sans relance agressive.",
    icon: "sparkle"
  },
  {
    title: "Vous ne gérez que les rendez-vous",
    description: "L’agent classe les réponses et vous alerte dès qu’un prospect est chaud.",
    icon: "target"
  }
];

const relancePoints = [
  {
    copy: "Choisit automatiquement le meilleur créneau.",
    icon: "calendar"
  },
  {
    copy: "Adapte l’angle : rappel, valeur, preuve sociale ou question.",
    icon: "sparkle"
  },
  {
    copy: "Message court (3–6 lignes) et modifiable à tout moment.",
    icon: "message"
  },
  {
    copy: "Explique son choix : \"Pourquoi ce timing ?\" pour rester transparent.",
    icon: "analytics"
  }
];

const dashboardStats = [
  { metric: "+48 %", description: "de réponses sur 30 jours grâce aux relances ciblées", icon: "spark" },
  { metric: "11 min", description: "de paramétrage pour lancer une séquence complète", icon: "clock" },
  { metric: "92 %", description: "des réponses qualifiées transformées en rendez-vous", icon: "target" }
];

const testimonials = [
  {
    name: "Camille, COO",
    quote: "On a doublé nos prises de rendez-vous sans recruter. L’agent gère le volume, l’équipe gère les deals."
  },
  {
    name: "Jules, Head of Growth",
    quote: "La relance intelligente est un no-brainer : bon moment, bon ton, pas de spam."
  },
  {
    name: "Sonia, SDR Lead",
    quote: "Je ne perds plus de temps à classer les réponses. Tout arrive déjà trié dans la console."
  }
];

const logos = ["NovaOps", "Shiftly", "QuantLeap", "Beryl", "Clarity"];

const securityHighlights = [
  "Données chiffrées au repos et en transit",
  "Opt-out et consentements respectés par canal",
  "Hébergement UE disponible sur demande",
  "Journal complet des actions et accès RBAC"
];

const pageTitle = "Pipelane – Votre assistant commercial qui ne dort jamais";
const pageDescription =
  "Pipelane centralise WhatsApp, Email et SMS, rédige et envoie des messages personnalisés, relance intelligemment et vous amène des rendez-vous qualifiés.";

const demoMode = (import.meta.env.PUBLIC_DEMO_MODE ?? "false") === "true";
const consoleUrl = (import.meta.env.PUBLIC_CONSOLE_URL ?? "http://localhost:4200").replace(/\/$/, "");

const productSchema = {
  "@context": "https://schema.org",
  "@type": "Product",
  name: "Pipelane",
  description: pageDescription,
  brand: { "@type": "Brand", name: "Pipelane" },
  offers: [
    {
      "@type": "Offer",
      priceCurrency: "EUR",
      price: "290",
      availability: "https://schema.org/InStock",
      url: "https://www.pipelane.app/prix"
    }
  ]
};

const faqSchema = {
  "@context": "https://schema.org",
  "@type": "FAQPage",
  mainEntity: [
    {
      "@type": "Question",
      name: "Comment fonctionne l’agent de prospection IA ?",
      acceptedAnswer: {
        "@type": "Answer",
        text: "Vous connectez vos canaux, importez votre pitch et vos contacts. L’agent écrit, envoie, relance et classe les réponses ; vous validez ou modifiez les propositions avant envoi."
      }
    },
    {
      "@type": "Question",
      name: "La relance intelligente respecte-t-elle les opt-out ?",
      acceptedAnswer: {
        "@type": "Answer",
        text: "Oui, l’agent intègre les consentements canal par canal, respecte les quiet hours et explique chaque choix de relance avant validation."
      }
    },
    {
      "@type": "Question",
      name: "Ai-je besoin d’autres outils (n8n, Zapier) pour commencer ?",
      acceptedAnswer: {
        "@type": "Answer",
        text: "Non, tout tourne dans Pipelane. Des ports optionnels (événements sortants, actions entrantes) sont disponibles plus tard si vous souhaitez des intégrations spécifiques."
      }
    }
  ]
};
---
<BaseLayout title={pageTitle} description={pageDescription} canonical="https://www.pipelane.app/">
  <Fragment slot="head">
    <script type="application/ld+json">{JSON.stringify(productSchema)}</script>
    <script type="application/ld+json">{JSON.stringify(faqSchema)}</script>
  </Fragment>
  <Navbar currentPath={Astro.url.pathname} />
  <main class="space-y-32 lg:space-y-44">
    <section id="hero" class="section relative overflow-hidden">
      <div class="container-page">
        <div class="grid items-center gap-10 md:grid-cols-2 md:gap-12">
          <div class="space-y-7 lg:space-y-8">
            <NeonBadge text="Console omni-canale + Agent IA" />
            <h1 class="text-balance font-semibold on-surface-strong max-w-[42ch]">
              Votre assistant commercial qui ne dort jamais
            </h1>
            <p class="max-w-[42ch] text-lg leading-relaxed on-surface">
              Pipelane centralise WhatsApp, Email et SMS, rédige et envoie des messages personnalisés, relance intelligemment et vous amène des rendez-vous qualifiés — sans charge mentale.
            </p>
            <ul class="flex flex-wrap gap-2 text-xs font-semibold uppercase tracking-[0.3em]">
              {heroBullets.map((item) => (
                <li
                  key={item.label}
                  class="inline-flex items-center gap-2 rounded-full bg-white/10 px-3 py-1 text-xs uppercase tracking-[0.28em] on-surface-strong"
                >
                  <span class="text-primary">
                    <Icon name={item.icon} size={16} />
                  </span>
                  {item.label}
                </li>
              ))}
            </ul>
            <div class="flex flex-col gap-3 pt-4 sm:flex-row sm:items-center">
              <a
                href="#demo"
                class="btn-primary min-h-[44px] rounded-xl px-5 shadow-glow focus:outline-none focus-visible:ring-2 focus-visible:ring-primary/60"
                data-analytics="cta_click"
                data-location="hero-primary"
              >
                Demander une démo
              </a>
              {demoMode && (
                <a
                  href={`${consoleUrl}/login?demo=1`}
                  class="btn-ghost min-h-[44px] rounded-xl px-5 focus:outline-none focus-visible:ring-2 focus-visible:ring-primary/60"
                  data-analytics="cta_click"
                  data-location="hero-demo"
                >
                  Lancer la démo
                </a>
              )}
              <a
                href="/prospection-ia"
                class="btn-ghost min-h-[44px] rounded-xl px-5 focus:outline-none focus-visible:ring-2 focus-visible:ring-primary/60"
                data-analytics="cta_click"
                data-location="hero-secondary"
              >
                Voir l’agent de prospection
              </a>
            </div>
            <div class="glass max-w-xl rounded-2xl border border-line/25 p-6 shadow-soft">
              <DemoForm idPrefix="hero" compact />
            </div>
          </div>
          <div class="relative isolate" data-parallax data-parallax-speed="0.24">
            <div class="absolute -left-12 -top-16 h-52 w-52 rounded-full bg-primary/28 blur-3xl"></div>
            <div class="absolute -bottom-12 right-0 h-56 w-56 rounded-full bg-secondary/28 blur-3xl"></div>
            <div class="relative space-y-5">
              <figure class="glass overflow-hidden rounded-2xl border border-line/25 shadow-soft">
                <div class="relative aspect-[16/10] md:aspect-[4/3]">
                  <img
                    src="/og-cover.png"
                    alt="Console Pipelane"
                    loading="lazy"
                    decoding="async"
                    class="h-full w-full object-cover"
                  />
                </div>
              </figure>
              <div class="grid gap-4 text-sm">
                <div class="glass flex items-center gap-3 rounded-2xl border border-line/30 px-4 py-3 on-surface">
                  <span class="flex h-10 w-10 items-center justify-center rounded-full bg-primary/14 text-primary">
                    <Icon name="sparkle" size={22} />
                  </span>
                  <div>
                    <p class="text-xs uppercase tracking-[0.3em] text-primary">Séquence en direct</p>
                    <p class="on-surface-strong">Campagne “Scale Series A” · 132 prospects actifs</p>
                  </div>
                </div>
                <div class="glass flex items-center justify-between rounded-2xl border border-line/25 px-4 py-3 on-surface">
                  <div>
                    <p class="text-xs uppercase tracking-[0.3em] text-primary">Prochaine relance</p>
                    <p class="mt-1 on-surface-strong">Jeudi 14:30 · angle preuve sociale</p>
                  </div>
                  <div class="text-right text-xs text-textMuted">
                    <p>score IA : 92</p>
                    <p>fenêtre WhatsApp OK</p>
                  </div>
                </div>
                <div class="glass flex items-start gap-3 rounded-2xl border border-line/20 px-4 py-3 on-surface">
                  <span class="mt-1 flex h-8 w-8 items-center justify-center rounded-full bg-secondary/15 text-secondary">
                    <Icon name="rocket" size={20} />
                  </span>
                  <div>
                    <p class="text-sm font-semibold on-surface-strong">Camille a répondu “Let’s book 30 min”</p>
                    <p class="text-xs text-textMuted">L’agent a proposé 3 créneaux, joint la fiche CRM et noté la température (4/5).</p>
                  </div>
                </div>
                <div class="glass flex items-start gap-3 rounded-2xl border border-line/20 px-4 py-3 on-surface">
                  <span class="mt-1 flex h-8 w-8 items-center justify-center rounded-full bg-accent/15 text-accent">
                    <Icon name="calendar" size={20} />
                  </span>
                  <div>
                    <p class="text-sm font-semibold on-surface-strong">2 créneaux proposés</p>
                    <p class="text-xs text-textMuted">Emails, WhatsApp & SMS sont alignés. L’agent respecte vos quiet hours.</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
      </div>
    </section>

    <Section
      id="gains"
      eyebrow="Ce que vous gagnez"
      title="Trois résultats dès la première semaine"
      description="L’agent IA travaille à votre place, avec votre ton, et vous libère du suivi quotidien."
      contentClass="mt-12 grid gap-7 md:grid-cols-3"
    >
      {gains.map((gain) => (
        <div class="reveal glass group relative overflow-hidden rounded-3xl border border-line/30 p-6 transition hover:-translate-y-1 hover:border-primary/40 hover:shadow-glow">
          <div class="absolute -right-10 -top-10 h-32 w-32 rounded-full bg-primary/10 opacity-70 blur-3xl transition group-hover:opacity-100"></div>
          <span class="relative inline-flex h-12 w-12 items-center justify-center rounded-2xl bg-primary/15 text-primary">
            <Icon name={gain.icon} size={26} />
          </span>
          <h3 class="relative mt-6 text-xl font-semibold on-surface-strong">{gain.title}</h3>
          <p class="relative mt-3 text-sm leading-relaxed on-surface">{gain.description}</p>
        </div>
      ))}
    </Section>

    <Section
      id="marche"
      eyebrow="Comment ça marche"
      title="L’agent s’occupe de tout, vous ne gérez que les rendez-vous"
      description="Une mise en route simple pour une prospection qui tourne en continu."
      contentClass="mt-12 grid gap-6 md:grid-cols-2"
    >
      {workflowSteps.map((step, index) => (
        <div class="reveal glass group rounded-3xl border border-line/30 p-6 transition hover:border-primary/40 hover:shadow-soft">
          <div class="flex items-start gap-4">
            <span class="flex h-11 w-11 items-center justify-center rounded-full bg-primary/15 text-primary font-semibold">
              {String(index + 1).padStart(2, "0")}
            </span>
            <div class="space-y-3">
              <div class="flex items-center gap-2 text-xs uppercase tracking-[0.32em] text-primary/80">
                <Icon name={step.icon} size={18} />
                Étape {index + 1}
              </div>
              <h3 class="text-lg font-semibold on-surface-strong">{step.title}</h3>
              <p class="text-sm leading-relaxed on-surface">{step.description}</p>
            </div>
          </div>
        </div>
      ))}
    </Section>

    <Section
      id="relance"
      eyebrow="Relance intelligente"
      title="La relance qui ne saoule pas"
      description="Bon moment, bon angle, 3–6 lignes utiles. Modifiable à tout instant avec explication « Pourquoi ce choix ? »."
      variant="panel"
      contentClass="grid gap-6 lg:grid-cols-[minmax(0,1fr)_minmax(0,1fr)]"
    >
      <div class="space-y-4 text-sm leading-relaxed on-surface">
        <ul class="space-y-3">
          {relancePoints.map((point) => (
            <li class="flex items-start gap-3">
              <span class="mt-1 text-primary">
                <Icon name={point.icon} size={18} />
              </span>
              <span>{point.copy}</span>
            </li>
          ))}
        </ul>
        <div class="rounded-3xl border border-line/40 bg-surfaceOverlay/80 p-5">
          <p class="text-xs uppercase tracking-[0.3em] text-primary">Carte d’exemple</p>
          <p class="mt-2 text-sm on-surface-strong">Prochaine relance : Jeudi 15:00 · angle preuve sociale</p>
          <p class="mt-2 text-xs text-textMuted">Suggestion : “Nous venons d’accompagner NovaOps sur le même enjeu, voici le retour en 2 points…”</p>
        </div>
      </div>
      <div class="rounded-3xl border border-line/30 bg-surfaceOverlay/60 p-6 text-sm leading-relaxed on-surface">
        <p class="text-xs uppercase tracking-[0.3em] text-primary">Pourquoi vous allez aimer</p>
        <p class="mt-3 on-surface-strong">
          L’agent connaît l’historique, respecte les quiet hours, intègre vos opt-out et vous laisse la main. Vous validez en un clic ou modifiez avant envoi.
        </p>
      </div>
    </Section>

    <Section
      id="mvp"
      eyebrow="MVP sans n8n"
      title="Tout tourne dans Pipelane"
      description="Pas besoin d’un stack complexe pour démarrer. Consolidez votre prospection dans un seul outil, prêt à l’emploi."
      contentClass="mt-12 grid gap-6 lg:grid-cols-[minmax(0,1fr)_minmax(0,1fr)]"
    >
      <div class="reveal glass rounded-3xl border border-line/30 p-6 text-sm leading-relaxed on-surface">
        <p>
          L’agent écrit, envoie, relance et classe les réponses au sein de la console. Besoin d’intégrations spécifiques ?
          Activez nos deux ports optionnels (événements sortants, actions entrantes) quand vous le souhaitez.
        </p>
        <ul class="mt-4 space-y-2 text-sm">
          <li class="flex items-center gap-2 text-primary"><span class="h-2 w-2 rounded-full bg-primary"></span>Ports optionnels prêts mais désactivés par défaut</li>
          <li class="flex items-center gap-2 text-primary"><span class="h-2 w-2 rounded-full bg-primary"></span>Relances et suivi natifs, sans n8n</li>
          <li class="flex items-center gap-2 text-primary"><span class="h-2 w-2 rounded-full bg-primary"></span>Console unique pour le support, la vente et la réussite client</li>
        </ul>
      </div>
      <div class="reveal rounded-3xl border border-dashed border-primary/40 bg-primary/10 p-6 text-sm leading-relaxed text-primary">
        <p class="font-semibold uppercase tracking-[0.3em]">Ports optionnels</p>
        <p class="mt-2">• Webhooks sortants (événements conversation, réponses, relances)</p>
        <p>• Actions entrantes (créer un ticket, pousser un événement CRM)</p>
        <p class="mt-3 text-primary/70">Activez-les quand vous voulez, sans toucher au cœur du produit.</p>
      </div>
    </Section>

    <Section
      id="dashboard"
      eyebrow="Tableau de bord"
      title="Pilotez vos conversations et vos conversions"
      description="Envoyés, délivrés, ouverts, réponses, rendez-vous : tout est suivi en temps réel avec des vues prêtes."
      center
      contentClass="mt-12 grid gap-6 md:grid-cols-3"
    >
      {dashboardStats.map((stat) => (
        <StatCard metric={stat.metric} description={stat.description} icon={stat.icon} />
      ))}
    </Section>

    <Section
      id="preuve"
      eyebrow="Preuve & réassurance"
      title="Des équipes commerciales & growth qui dorment mieux"
      description="Ils nous utilisent déjà pour garder le rythme sans épuiser les équipes."
      contentClass="mt-12 grid gap-8 lg:grid-cols-[minmax(0,2fr)_minmax(0,1fr)]"
    >
      <div class="space-y-6">
        <div class="grid gap-6 md:grid-cols-3">
          {testimonials.map((testimonial) => (
            <div class="reveal glass group rounded-3xl border border-line/30 p-6 text-sm leading-relaxed on-surface transition hover:-translate-y-1 hover:border-primary/35 hover:shadow-soft">
              <span class="inline-flex h-10 w-10 items-center justify-center rounded-full bg-secondary/15 text-secondary transition group-hover:rotate-3">
                <Icon name="sparkle" size={20} />
              </span>
              <p class="mt-4 text-textMuted">“{testimonial.quote}”</p>
              <p class="mt-5 text-xs uppercase tracking-[0.3em] text-primary">{testimonial.name}</p>
            </div>
          ))}
        </div>
        <div class="flex flex-wrap items-center gap-4 text-xs uppercase tracking-[0.35em] text-textMuted">
          {logos.map((logo) => (
            <span class="rounded-full border border-line/20 px-4 py-2 transition hover:border-primary/40 hover:text-primary">
              {logo}
            </span>
          ))}
        </div>
      </div>
      <div class="reveal glass-strong space-y-4 rounded-3xl border border-line/30 p-6 text-sm leading-relaxed on-surface">
        <p class="text-xs uppercase tracking-[0.3em] text-primary">Sécurité & RGPD</p>
        <ul class="space-y-3">
          {securityHighlights.map((item) => (
            <li class="flex items-start gap-3">
              <span class="mt-1 text-primary">
                <Icon name="shield" size={18} />
              </span>
              <span>{item}</span>
            </li>
          ))}
        </ul>
      </div>
    </Section>

    <CTA
      id="demo"
      title="Remplissez votre pipe sans écrire un seul email"
      description="Réservez une démo : on connecte vos canaux, on importe votre pitch et votre agent IA est prêt en moins d’une heure."
      primaryLabel="Demander une démo"
      secondaryLabel="Voir la prospection IA"
      secondaryHref="/prospection-ia"
    />
  </main>
  <Footer />
</BaseLayout>
