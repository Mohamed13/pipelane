---
import BaseLayout from "@layouts/Base.astro";
import Navbar from "@components/Navbar.astro";
import Footer from "@components/Footer.astro";
import NeonBadge from "@components/NeonBadge.astro";

const posts = (await Astro.glob('./*.md')).sort((a, b) => new Date(b.frontmatter.date).getTime() - new Date(a.frontmatter.date).getTime());
const metaTitle = 'Ressources & blog – Pipelane';
const metaDescription = 'Articles et guides pour lancer votre prospection IA, optimiser vos relances et construire un MVP sans dette technique.';
---
<BaseLayout title={metaTitle} description={metaDescription} canonical="https://www.pipelane.app/blog">
  <Navbar currentPath={Astro.url.pathname} />
  <main class="space-y-20">
    <section class="section">
      <div class="container-page space-y-6">
        <NeonBadge text="Ressources" />
        <h1 class="text-balance font-semibold on-surface-strong text-4xl sm:text-5xl">Blog & avant-premières</h1>
        <p class="max-w-3xl text-lg leading-relaxed on-surface">Retrouvez nos brouillons, retours d’expérience et playbooks sur la prospection IA. Chaque article est encore en relecture : vos retours sont les bienvenus.</p>
      </div>
    </section>

    <section class="section pt-0">
      <div class="container-page grid gap-6 md:grid-cols-3">
      {posts.map((post, index) => {
        const headingId = `post-${index}`;
        return (
          <article class="glass rounded-3xl border border-white/10 p-6 text-sm leading-relaxed on-surface" aria-labelledby={headingId}>
            <p class="text-xs uppercase tracking-[0.35em] text-primary/80">Brouillon</p>
            <h2 id={headingId} class="mt-3 text-lg font-semibold on-surface-strong">
              {post.frontmatter.title}
            </h2>
            <p class="mt-2 text-textMuted">{post.frontmatter.description}</p>
            <p class="mt-4 text-xs text-textMuted">
              Publié le {new Date(post.frontmatter.date).toLocaleDateString('fr-FR')}
            </p>
            <a href={post.url} class="mt-6 inline-flex items-center gap-2 text-sm font-semibold text-primary underline underline-offset-4">
              Lire le brouillon →
            </a>
          </article>
        );
      })}
      </div>
    </section>
  </main>
  <Footer />
</BaseLayout>
